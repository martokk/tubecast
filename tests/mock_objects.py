from typing import Any

from datetime import datetime

MOCKED_RUMBLE_VIDEO_1: dict[str, Any] = {
    "id": "DthvvHVw",
    "source_id": "7hyhcvzT",
    "handler": "RumbleHandler",
    "uploader": "Styxhexenhammer666",
    "uploader_id": "Styxhexenhammer666",
    "title": "Monday LIVE: Bidens Scandal Worsens, Antifa Riots in Atlanta, etc (Superchats)",
    "description": 'Durbin tosses Biden under the bus: https://archive.ph/gFs11\nAntifa riots in Atlanta: https://archive.ph/tw9b6\nIntel simps: https://archive.ph/h3R4t\nHOW DARE YOU question Davos: https://archive.ph/HHDxh\nSNAP "reform": https://archive.ph/zDJwb\nIs Nikki Haley insane?: https://archive.ph/Y1uvH\nPolish tanks in Ukraine?: https://twitter.com/disclosetv/status/1617251304526553088Show more\nSupport via donation:\nPatreon: https://tinyurl.com/y2jothtp\nSubscribestar: https://tinyurl.com/yyxov782\nMy books:\nBlogger: https://tinyurl.com/y3tww3om\nWordpress: https://tinyurl.com/y54kofgl\nWhere to Find Me:\nSubstack: https://tarl.substack.com\nYoutube: https://tinyurl.com/y6zc4quo\nBitchute: https://tinyurl.com/y55lzhlz\nRumble: https://tinyurl.com/y5692j87\nOdysee: https://tinyurl.com/y4fsbqzz\nMinds: https://tinyurl.com/y3ytf6ut\nTwitter: https://tinyurl.com/yyle5u6s\nGab: https://tinyurl.com/y2rctakd\nGettr: https://www.gettr.com/user/styx666official\nBTC: 17q1BfF2up8orEKN8DQgpEPX83RfbAZ5QL\nETH: 0x956e7aF6706C3b5E2cf7e15c16c7018c4f42aF79\nLTC: LQNJed6vDhR4U4LB7g8jGep4UQ7yeqJdPw\nDogecoin: DNYSanJEY8fbxUzwjTJWA3d1Sna9hra4NJ\nBCH: qz2wtp2w8grldn7gw5guqc42zxsgwuen8qxk49mhv9\nSHIB: 0x956e7aF6706C3b5E2cf7e15c16c7018c4f42aF79\n#Stream #Live Show less',
    "duration": 3270,
    "thumbnail": "https://sp.rmbl.ws/s8/6/a/f/W/4/afW4h.qR4e.1.jpg",
    "url": "https://rumble.com/v26s0u8-monday-live-bidens-scandal-worsens-antifa-riots-in-atlanta-etc-superchats.html",
    "media_url": "https://sp.rmbl.ws/s8/2/a/f/W/4/afW4h.oaa.rec.mp4",
    "feed_media_url": "/media/DthvvHVw",
    "media_filesize": 83836874,
    "released_at": "2023-01-23T12:09:29",
}

MOCKED_RUMBLE_VIDEO_2: dict[str, Any] = {
    "created_at": "2023-01-26T22:51:02.046597",
    "updated_at": "2023-01-26T22:51:02.046587",
    "id": "VCyJgqtb",
    "source_id": "7hyhcvzT",
    "handler": "RumbleHandler",
    "uploader": "Styxhexenhammer666",
    "uploader_id": "Styxhexenhammer666",
    "title": "LEGENDARY Cope as Trump-Investigating McGonigal is Arrested for Ties to Russian Oligarch",
    "description": "Oopsie: https://archive.ph/dLm99Show more\nSupport via donation:\nPatreon: https://tinyurl.com/y2jothtp\nSubscribestar: https://tinyurl.com/yyxov782\nMy books:\nBlogger: https://tinyurl.com/y3tww3om\nWordpress: https://tinyurl.com/y54kofgl\nWhere to Find Me:\nSubstack: https://tarl.substack.com\nYoutube: https://tinyurl.com/y6zc4quo\nBitchute: https://tinyurl.com/y55lzhlz\nRumble: https://tinyurl.com/y5692j87\nOdysee: https://tinyurl.com/y4fsbqzz\nMinds: https://tinyurl.com/y3ytf6ut\nTwitter: https://tinyurl.com/yyle5u6s\nGab: https://tinyurl.com/y2rctakd\nGettr: https://www.gettr.com/user/styx666official\nBTC: 17q1BfF2up8orEKN8DQgpEPX83RfbAZ5QL\nETH: 0x956e7aF6706C3b5E2cf7e15c16c7018c4f42aF79\nLTC: LQNJed6vDhR4U4LB7g8jGep4UQ7yeqJdPw\nDogecoin: DNYSanJEY8fbxUzwjTJWA3d1Sna9hra4NJ\nBCH: qz2wtp2w8grldn7gw5guqc42zxsgwuen8qxk49mhv9\nSHIB: 0x956e7aF6706C3b5E2cf7e15c16c7018c4f42aF79\n#cope #mcgonigal Show less",
    "duration": 445,
    "thumbnail": "https://sp.rmbl.ws/s8/6/s/r/I/5/srI5h.OvCc.jpg",
    "url": "https://rumble.com/v26wfgy-legendary-cope-as-trump-investigating-mcgonigal-is-arrested-for-ties-to-rus.html",
    "media_url": "https://sp.rmbl.ws/s8/2/s/r/I/5/srI5h.baa.mp4",
    "feed_media_url": "/media/VCyJgqtb",
    "media_filesize": 35723527,
    "released_at": "2023-01-24T09:32:45",
}

MOCKED_RUMBLE_VIDEO_3: dict[str, Any] = {
    "id": "C7fSjqud",
    "source_id": "mLC5c5NH",
    "handler": "RumbleHandler",
    "uploader": "Kim Iversen",
    "uploader_id": "Kim Iversen",
    "title": "Kari Lake Won't Back Down. An Update On Her Lawsuit and Will She Run For Senate",
    "description": "The Kim Iversen Show LIVE",
    "duration": 4187,
    "thumbnail": "https://sp.rmbl.ws/s8/1/a/2/O/2/a2O2h.qR4e.2-small-Kari-Lake-Wont-Back-Down.-A.jpg",
    "url": "https://rumble.com/v26g5fk-the-kim-iversen-show-live-january-20-2023.html",
    "media_url": "https://sp.rmbl.ws/s8/2/a/2/O/2/a2O2h.oaa.rec.mp4",
    "feed_media_url": "/media/C7fSjqud",
    "media_filesize": 106503449,
    "released_at": "2023-01-20T20:38:29",
}

MOCKED_YOUTUBE_VIDEO_1: dict[str, Any] = {
    "id": "YgsZwKRt",
    "source_id": "iQEQPfeQ",
    "handler": "YoutubeHandler",
    "uploader": "Breaking Points",
    "uploader_id": "UCDRIjKy6eZOvKtOELtTdeUA",
    "title": "GOP 2022 Strategy: RUN ON NOTHING | Breaking Points with Krystal and Saagar",
    "description": "",
    "duration": 39,
    "thumbnail": "https://i.ytimg.com/vi/SLM_E-N9qts/sd2.jpg?sqp=-oaymwEoCIAFEOAD8quKqQMcGADwAQH4AZQDgALQBYoCDAgAEAEYfyBYKC0wDw==&rs=AOn4CLBhZqayVTzR862zAE9O8Tv_C2oDYQ",
    "url": "https://www.youtube.com/watch?v=SLM_E-N9qts",
    "media_url": "https://rr1---sn-vgqsrne6.googlevideo.com/videoplayback?expire=1674805357&ei=DSzTY5yyKKyQ2_gP8Y-wwAU&ip=72.133.133.99&id=o-AFdRz_RPujuRd6d0HgdXPv7yI1f65fdl552FoeP-yFVD&itag=18&source=youtube&requiressl=yes&mh=w_&mm=31%2C29&mn=sn-vgqsrne6%2Csn-vgqskne6&ms=au%2Crdu&mv=m&mvi=1&pl=18&ctier=SH&initcwndbps=1481250&spc=H3gIhi0d8gOm5kL4hfKt3lfNQQpMJc8&vprv=1&svpuc=1&mime=video%2Fmp4&cnr=14&ratebypass=yes&dur=39.125&lmt=1665155526847808&mt=1674783448&fvip=2&fexp=24007246&c=ANDROID&txp=5430434&sparams=expire%2Cei%2Cip%2Cid%2Citag%2Csource%2Crequiressl%2Cctier%2Cspc%2Cvprv%2Csvpuc%2Cmime%2Ccnr%2Cratebypass%2Cdur%2Clmt&sig=AOq0QJ8wRQIhAKfbaX4bB3_zUHqYHt_OCCwSeAQMJkZlV2eHIb406gfyAiB_jgq4MKz9kr_83hkue9kgCY20dijv5I8hlyBEo1h03Q%3D%3D&lsparams=mh%2Cmm%2Cmn%2Cms%2Cmv%2Cmvi%2Cpl%2Cinitcwndbps&lsig=AG3C_xAwRQIhANT2aUV15TBYxP7noQfM8Xa-URCaSXm4DsXLpF-hXKGwAiBe93-rCcQVx3xgM139dg0zADMVaDEURQTw3fD5vzN_pg%3D%3D",
    "feed_media_url": "/media/YgsZwKRt",
    "media_filesize": 1012372,
    "released_at": "2022-02-04T00:00:00",
}
MOCKED_YOUTUBE_VIDEO_2: dict[str, Any] = {
    "id": "BKsPQaDh",
    "source_id": "iQEQPfeQ",
    "handler": "YoutubeHandler",
    "uploader": "Breaking Points",
    "uploader_id": "UCDRIjKy6eZOvKtOELtTdeUA",
    "title": "Russians FLEE After Putins Drafts 300,000 #shorts",
    "description": "",
    "duration": 56,
    "thumbnail": "https://i.ytimg.com/vi/U9BJQhHDu2Y/sd2.jpg?sqp=-oaymwEoCIAFEOAD8quKqQMcGADwAQH4Ac4FgAKACooCDAgAEAEYSCBUKHIwDw==&rs=AOn4CLDcfUIVyksReBPl9qXKCwWcqgZQkw",
    "url": "https://www.youtube.com/watch?v=U9BJQhHDu2Y",
    "media_url": "https://rr1---sn-vgqsrnzz.googlevideo.com/videoplayback?expire=1674805358&ei=DizTY_qfKeXuiwSY_YL4Cw&ip=72.133.133.99&id=o-AKVrVFbH5ftUtSHhto_UsjdSzqZNXoG0FgV9YKw4V44O&itag=18&source=youtube&requiressl=yes&mh=wQ&mm=31%2C29&mn=sn-vgqsrnzz%2Csn-vgqsknz7&ms=au%2Crdu&mv=m&mvi=1&pl=18&ctier=SH&initcwndbps=1513750&spc=H3gIhleTht_wwJep7TdPZ-R0c6mM5qw&vprv=1&svpuc=1&mime=video%2Fmp4&cnr=14&ratebypass=yes&dur=55.936&lmt=1666282679125490&mt=1674783448&fvip=2&fexp=24007246&c=ANDROID&txp=5430434&sparams=expire%2Cei%2Cip%2Cid%2Citag%2Csource%2Crequiressl%2Cctier%2Cspc%2Cvprv%2Csvpuc%2Cmime%2Ccnr%2Cratebypass%2Cdur%2Clmt&sig=AOq0QJ8wRQIgXFX53Kd51hwRjYgH4JWY0rZayzqsjAhN0jq0tAVojqcCIQDUnxmDDGwAczI0l7g8uczVeRzWwqc_5tLwlu6CdKWCbQ%3D%3D&lsparams=mh%2Cmm%2Cmn%2Cms%2Cmv%2Cmvi%2Cpl%2Cinitcwndbps&lsig=AG3C_xAwRgIhAJX8CiHI_n04XzdNIQmnTDHVO_zRSj857IEU01ytPTP7AiEAlNgwLgPiiX0fl7D6TNvBxY6nxK9tRRiI7WQI6ZrUVTo%3D",
    "feed_media_url": "/media/BKsPQaDh",
    "media_filesize": 3259289,
    "released_at": "2022-09-22T00:00:00",
}


MOCKED_RUMBLE_SOURCE_1: dict[str, Any] = {
    "id": "7hyhcvzT",
    "url": "https://www.rumble.com/c/styxhexenhammer666",
    "name": "Styxhexenhammer666",
    "logo": "https://sp.rmbl.ws/z8/t/j/s/b/tjsba.baa.1-Styxhexenhammer666-qyv16v.png",
    "ordered_by": "released_at",
    "feed_url": "/feed/7hyhcvzT",
    "handler": "RumbleHandler",
    "author": "Styxhexenhammer666",
    "description": "Styxhexenhammer666's Rumble Channel",
    "extractor": "CustomRumbleChannel",
    "created_by": "ZbFPeSXW",
    "videos": [
        MOCKED_RUMBLE_VIDEO_1,
        MOCKED_RUMBLE_VIDEO_2,
    ],
}

MOCKED_RUMBLE_SOURCE_2: dict[str, Any] = {
    "id": "mLC5c5NH",
    "url": "https://www.rumble.com/c/kimiversen",
    "name": "Kim Iversen",
    "author": "Kim Iversen",
    "logo": "https://sp.rmbl.ws/z8/k/N/n/f/kNnfa.baa-KimIversen-r6nek8.png",
    "description": "Kim Iversen's Rumble Channel",
    "ordered_by": "released_at",
    "feed_url": "/feed/mLC5c5NH",
    "extractor": "CustomRumbleChannel",
    "handler": "RumbleHandler",
    "created_by": "ZbFPeSXW",
    "videos": [
        MOCKED_RUMBLE_VIDEO_3,
    ],
}

MOCKED_YOUTUBE_SOURCE_1: dict[str, Any] = {
    "id": "RUF4Nbzd",
    "url": "https://www.youtube.com/channel/UCDRIjKy6eZOvKtOELtTdeUA",
    "name": "Breaking Points",
    "author": "Breaking Points",
    "logo": "https://yt3.googleusercontent.com/zdnjHL8qsI_qgm0ahVLaGg2L0-WDSMeWuSecs-I1APcEHJIq_GXNEsDzwMAwfu3jzSmdflJ_VU4=w640-fcrop64=1,32b75a57cd48a5a8-k-c0xffffffff-no-nd-rj",
    "description": "Breaking Points with Krystal and Saagar is a fearless anti-establishment Youtube show and podcast. ",
    "ordered_by": "released_at",
    "feed_url": "/feed/RUF4Nbzd",
    "extractor": "YoutubeTab",
    "handler": "YoutubeHandler",
    "created_by": "ZbFPeSXW",
    "videos": [MOCKED_YOUTUBE_VIDEO_1, MOCKED_YOUTUBE_VIDEO_2],
}

MOCKED_SOURCES: list[dict[str, Any]] = [
    MOCKED_YOUTUBE_SOURCE_1,
    MOCKED_RUMBLE_SOURCE_1,
    MOCKED_RUMBLE_SOURCE_2,
]


async def get_mocked_source_info_dict(*args: Any, **kwargs: Any) -> dict[str, Any]:
    url = kwargs.get("url")
    for mocked_source in MOCKED_SOURCES:
        if mocked_source["url"] == url:
            return {
                "url": mocked_source["url"],
                "title": mocked_source["name"],
                "uploader": mocked_source["author"],
                "thumbnail": mocked_source["logo"],
                "description": mocked_source["description"],
                "extractor_key": mocked_source["extractor"],
                "thumbnails": [
                    {"url": mocked_source["logo"]},
                    {"url": mocked_source["logo"]},
                    {"url": mocked_source["logo"]},
                ],
                "_type": "playlist",
                "metadata": {
                    "url": mocked_source["url"],
                },
                "entries": [
                    {
                        "title": video["title"],
                        "description": video["description"],
                        "url": video["url"],
                        "webpage_url": video["url"],
                        "original_url": video["url"],
                        "timestamp": datetime.strptime(
                            video["released_at"], "%Y-%m-%dT%H:%M:%S"
                        ).timestamp(),
                        "upload_date": video["released_at"].split("T")[0].replace("-", ""),
                        "duration": video["duration"],
                        "thumbnail": video["thumbnail"],
                        "uploader": video["uploader"],
                        "uploader_id": video["uploader_id"],
                        "channel": video["uploader"],
                        "channel_id": video["uploader_id"],
                        "_type": "url",
                        "format_id": "0",
                        "formats": [
                            {
                                "format_id": "0",
                                "url": video["feed_media_url"],
                                "filesize": video["media_filesize"],
                            }
                        ],
                    }
                    for video in mocked_source["videos"]
                ],
            }

    raise Exception(f"Mocked source not found for url: {url}")


async def get_mocked_video_info_dict(*args: Any, **kwargs: Any) -> dict[str, Any]:
    url = kwargs.get("url")
    mocked_videos = [video for source in MOCKED_SOURCES for video in source["videos"]]
    for mocked_video in mocked_videos:
        if mocked_video["url"] == url:
            return {
                "title": mocked_video["title"],
                "description": mocked_video["description"],
                "webpage_url": mocked_video["url"],
                "original_url": mocked_video["url"],
                "timestamp": datetime.strptime(
                    mocked_video["released_at"], "%Y-%m-%dT%H:%M:%S"
                ).timestamp(),
                "upload_date": mocked_video["released_at"].split("T")[0].replace("-", ""),
                "duration": mocked_video["duration"],
                "thumbnail": mocked_video["thumbnail"],
                "uploader": mocked_video["uploader"],
                "uploader_id": mocked_video["uploader_id"],
                "channel": mocked_video["uploader"],
                "channel_id": mocked_video["uploader_id"],
                "_type": "url",
                "format_id": "mp4",
                "formats": [
                    {
                        "format_id": "mp4",
                        "url": mocked_video["media_url"],
                        "filesize": mocked_video["media_filesize"],
                    }
                ],
            }

    raise Exception(f"Mocked source not found for url: {url}")
